surveyResults = read.csv(paste(backupfolder,
"survey/",
surveyFilename,
sep=''))
pData = data.frame(
participantID = fl$participantID[1],
location = location,
highPStory = highPStory,
highPRecordings = highPFiles,
lowPStory = lowPStory,
lowPRecordings = lowPFiles
)
pData = cbind(pData,distractionTaskResults,surveyResults)
return(pData)
}
return(NULL)
}
results.UK = data.frame()
results.USA = data.frame()
for(f in fileList){
dx = try(processFileLog(f))
if(!is.null(dx)){
if(dx$location=="USA"){
results.USA = rbind(results.USA,dx)
} else{
results.UK = rbind(results.UK,dx)
}
}
}
results.UK
results.USA
setwd("~/Documents/Bristol/Transmission/stats/")
backupfolder = "../OnlineBackups/11July/"
fileList = list.files(paste(backupfolder,"logs/",sep=''),"Files*")
justFilename = function(X){
sapply(X, function(x){
x = strsplit(X,"/")[[1]]
return(x[length(x)])
})
}
processFileLog = function(filename){
fl = read.csv(
paste(backupfolder,
"logs/",
filename,
sep=''), stringsAsFactors = F)
if(nrow(fl)>0){
highPFiles = paste(fl[grepl("highp",fl$filetype),]$filename, collapse = ",")
lowPFiles = paste(fl[grepl("lowp",fl$filetype),]$filename, collapse = ",")
storyOrder = "HighP,LowP"
if(min(which(grepl("highp",fl$filetype))) > min(which(grepl("lowp",fl$filetype)))){
storyOrder = "LowP,HighP"
}
highPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("highp",fl$filetype),]$filetype[1])]
lowPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("lowp",fl$filetype),]$filetype[1])]
location = "USA"
if(sum(grepl("UK",fl$participantID))>0){
location = "UK"
}
# Distraction task data
distractionTasks = fl[grepl("distraction",fl$filetype),]$filename
# need to include one row
distractionTaskResults = data.frame(participantID=fl$participantID[1])
if(length(distractionTasks)==0){
distractionTaskResults = data.frame(
"VSLT.p.Round1"=NA,
'VSLT.d.Round1'=NA,
'VSLT.pnd.Round1'=NA,
'VSLT.p_plus_pnd.Round1'=NA,
"VSLT.p.Round2"=NA,
'VSLT.d.Round2'=NA,
'VSLT.pnd.Round2'=NA,
'VSLT.p_plus_pnd.Round2'=NA
)
} else{
for(df in distractionTasks){
df_filename = justFilename(df)
dx = read.csv(paste(backupfolder,
"distractionTask/",
df_filename,sep=''), stringsAsFactors = F)
if(!"distractionTaskNumber" %in% names(dx)){
x = strsplit(fl[grepl(df,fl$filename),]$filetype[1],"_")[[1]]
dx$distractionTaskNum = as.numeric(x[length(x)])
}
VSLT.p_plus_pnd = mean(dx$playerTechnicalPoints, na.rm=T)
VSLT.p = mean(dx$playerLocationsCorrect, na.rm=T)
VSLT.d = mean(dx$playerSymbolsCorrect, na.rm=T)
VSLT.pnd = mean(dx$playerSymbolsAndLocationsCorrect, na.rm=T)
distractionTaskResults = cbind(distractionTaskResults,
data.frame(
VSLT.p=VSLT.p,
VSLT.d=VSLT.d,
VSLT.pnd=VSLT.pnd,
VSLT.p_plus_pnd=VSLT.p_plus_pnd
))
}
distractionTaskResults = distractionTaskResults[,2:ncol(distractionTaskResults)]
names(distractionTaskResults) = c(
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round1"),sep="."),
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round2"),sep="."))
}
# Survey
surveyFilename = justFilename(fl[grepl("Survey",fl$filetype),]$filename[1])
surveyResults = read.csv(paste(backupfolder,
"survey/",
surveyFilename,
sep=''))
pData = data.frame(
participantID = fl$participantID[1],
location = location,
highPStory = highPStory,
highPRecordings = highPFiles,
lowPStory = lowPStory,
lowPRecordings = lowPFiles
)
pData = cbind(pData,distractionTaskResults,surveyResults)
return(pData)
}
return(NULL)
}
results.UK = data.frame()
results.USA = data.frame()
for(f in fileList){
dx = processFileLog(f)
if(!is.null(dx)){
if(dx$location=="USA"){
results.USA = rbind(results.USA,dx)
} else{
results.UK = rbind(results.UK,dx)
}
}
}
setdiff(results.UK,dx)
setdiff(names(results.UK),names(dx))
dx$location
setdiff(names(results.USA),names(dx))
a = results.USA
b=  dx
setdiff(names(a),names(b))
setdiff(names(b),names(a))
sda = setdiff(names(a),names(b))
sdb = setdiff(names(b),names(a))
sda %in% names(a)
sda %in% names(b)
length(sda)==0
a
a[,sdb]= NA
a
b[,sda] = NA
a = a[,sort(names(a))]
b = b[,sort(names(b))]
rbind(a,b)
setwd("~/Documents/Bristol/Transmission/stats/")
backupfolder = "../OnlineBackups/11July/"
fileList = list.files(paste(backupfolder,"logs/",sep=''),"Files*")
justFilename = function(X){
sapply(X, function(x){
x = strsplit(X,"/")[[1]]
return(x[length(x)])
})
}
processFileLog = function(filename){
fl = read.csv(
paste(backupfolder,
"logs/",
filename,
sep=''), stringsAsFactors = F)
if(nrow(fl)>0){
highPFiles = paste(fl[grepl("highp",fl$filetype),]$filename, collapse = ",")
lowPFiles = paste(fl[grepl("lowp",fl$filetype),]$filename, collapse = ",")
storyOrder = "HighP,LowP"
if(min(which(grepl("highp",fl$filetype))) > min(which(grepl("lowp",fl$filetype)))){
storyOrder = "LowP,HighP"
}
highPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("highp",fl$filetype),]$filetype[1])]
lowPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("lowp",fl$filetype),]$filetype[1])]
location = "USA"
if(sum(grepl("UK",fl$participantID))>0){
location = "UK"
}
# Distraction task data
distractionTasks = fl[grepl("distraction",fl$filetype),]$filename
# need to include one row
distractionTaskResults = data.frame(participantID=fl$participantID[1])
if(length(distractionTasks)==0){
distractionTaskResults = data.frame(
"VSLT.p.Round1"=NA,
'VSLT.d.Round1'=NA,
'VSLT.pnd.Round1'=NA,
'VSLT.p_plus_pnd.Round1'=NA,
"VSLT.p.Round2"=NA,
'VSLT.d.Round2'=NA,
'VSLT.pnd.Round2'=NA,
'VSLT.p_plus_pnd.Round2'=NA
)
} else{
for(df in distractionTasks){
df_filename = justFilename(df)
dx = read.csv(paste(backupfolder,
"distractionTask/",
df_filename,sep=''), stringsAsFactors = F)
if(!"distractionTaskNumber" %in% names(dx)){
x = strsplit(fl[grepl(df,fl$filename),]$filetype[1],"_")[[1]]
dx$distractionTaskNum = as.numeric(x[length(x)])
}
VSLT.p_plus_pnd = mean(dx$playerTechnicalPoints, na.rm=T)
VSLT.p = mean(dx$playerLocationsCorrect, na.rm=T)
VSLT.d = mean(dx$playerSymbolsCorrect, na.rm=T)
VSLT.pnd = mean(dx$playerSymbolsAndLocationsCorrect, na.rm=T)
distractionTaskResults = cbind(distractionTaskResults,
data.frame(
VSLT.p=VSLT.p,
VSLT.d=VSLT.d,
VSLT.pnd=VSLT.pnd,
VSLT.p_plus_pnd=VSLT.p_plus_pnd
))
}
distractionTaskResults = distractionTaskResults[,2:ncol(distractionTaskResults)]
names(distractionTaskResults) = c(
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round1"),sep="."),
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round2"),sep="."))
}
# Survey
surveyFilename = justFilename(fl[grepl("Survey",fl$filetype),]$filename[1])
surveyResults = read.csv(paste(backupfolder,
"survey/",
surveyFilename,
sep=''))
pData = data.frame(
participantID = fl$participantID[1],
location = location,
highPStory = highPStory,
highPRecordings = highPFiles,
lowPStory = lowPStory,
lowPRecordings = lowPFiles
)
pData = cbind(pData,distractionTaskResults,surveyResults)
return(pData)
}
return(NULL)
}
combineDatasets = function(a,b){
# in a but not b
sda = setdiff(names(a),names(b))
# in b but not a
sdb = setdiff(names(b),names(a))
if(length(sda)==0 & length(sdb)==0){
return(rbind(a,b))
} else{
a[,sdb]= NA
b[,sda] = NA
a = a[,sort(names(a))]
b = b[,sort(names(b))]
return(rbind(a,b))
}
}
results.UK = data.frame()
results.USA = data.frame()
for(f in fileList){
dx = processFileLog(f)
if(!is.null(dx)){
if(dx$location=="USA"){
results.USA = combineDatasets(results.USA,dx)
} else{
results.UK = combineDatasets(results.UK,dx)
}
}
}
results.USA
nrow(results.USA)
setwd("~/Documents/Bristol/Transmission/stats/")
backupfolder = "../OnlineBackups/11July/"
fileList = list.files(paste(backupfolder,"logs/",sep=''),"Files*")
justFilename = function(X){
sapply(X, function(x){
x = strsplit(X,"/")[[1]]
return(x[length(x)])
})
}
processFileLog = function(filename){
fl = read.csv(
paste(backupfolder,
"logs/",
filename,
sep=''), stringsAsFactors = F)
if(nrow(fl)>0){
highPFiles = paste(fl[grepl("highp",fl$filetype),]$filename, collapse = ",")
lowPFiles = paste(fl[grepl("lowp",fl$filetype),]$filename, collapse = ",")
storyOrder = "HighP,LowP"
if(min(which(grepl("highp",fl$filetype))) > min(which(grepl("lowp",fl$filetype)))){
storyOrder = "LowP,HighP"
}
highPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("highp",fl$filetype),]$filetype[1])]
lowPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("lowp",fl$filetype),]$filetype[1])]
location = "USA"
if(sum(grepl("UK",fl$participantID))>0){
location = "UK"
}
# Distraction task data
distractionTasks = fl[grepl("distraction",fl$filetype),]$filename
# need to include one row
distractionTaskResults = data.frame(participantID=fl$participantID[1])
if(length(distractionTasks)==0){
distractionTaskResults = data.frame(
"VSLT.p.Round1"=NA,
'VSLT.d.Round1'=NA,
'VSLT.pnd.Round1'=NA,
'VSLT.p_plus_pnd.Round1'=NA,
"VSLT.p.Round2"=NA,
'VSLT.d.Round2'=NA,
'VSLT.pnd.Round2'=NA,
'VSLT.p_plus_pnd.Round2'=NA
)
} else{
for(df in distractionTasks){
df_filename = justFilename(df)
dx = read.csv(paste(backupfolder,
"distractionTask/",
df_filename,sep=''), stringsAsFactors = F)
if(!"distractionTaskNumber" %in% names(dx)){
x = strsplit(fl[grepl(df,fl$filename),]$filetype[1],"_")[[1]]
dx$distractionTaskNum = as.numeric(x[length(x)])
}
VSLT.p_plus_pnd = mean(dx$playerTechnicalPoints, na.rm=T)
VSLT.p = mean(dx$playerLocationsCorrect, na.rm=T)
VSLT.d = mean(dx$playerSymbolsCorrect, na.rm=T)
VSLT.pnd = mean(dx$playerSymbolsAndLocationsCorrect, na.rm=T)
distractionTaskResults = cbind(distractionTaskResults,
data.frame(
VSLT.p=VSLT.p,
VSLT.d=VSLT.d,
VSLT.pnd=VSLT.pnd,
VSLT.p_plus_pnd=VSLT.p_plus_pnd
))
}
distractionTaskResults = distractionTaskResults[,2:ncol(distractionTaskResults)]
names(distractionTaskResults) = c(
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round1"),sep="."),
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round2"),sep="."))
}
# Survey
surveyFilename = justFilename(fl[grepl("Survey",fl$filetype),]$filename[1])
surveyResults = read.csv(paste(backupfolder,
"survey/",
surveyFilename,
sep=''))
pData = data.frame(
participantID = fl$participantID[1],
location = location,
highPStory = highPStory,
highPRecordings = highPFiles,
lowPStory = lowPStory,
lowPRecordings = lowPFiles
)
pData = cbind(pData,distractionTaskResults,surveyResults)
return(pData)
}
return(NULL)
}
combineDatasets = function(a,b){
if(nrow(a)==0){
return(rbind(a,b))
}
# in a but not b
sda = setdiff(names(a),names(b))
# in b but not a
sdb = setdiff(names(b),names(a))
if(length(sda)==0 & length(sdb)==0){
return(rbind(a,b))
} else{
a[,sdb]= NA
b[,sda] = NA
a = a[,sort(names(a))]
b = b[,sort(names(b))]
return(rbind(a,b))
}
}
results.UK = data.frame()
results.USA = data.frame()
for(f in fileList){
dx = processFileLog(f)
if(!is.null(dx)){
if(dx$location=="USA"){
results.USA = combineDatasets(results.USA,dx)
} else{
results.UK = combineDatasets(results.UK,dx)
}
}
}
results.UK
results.USA
getwd()
setwd("~/Documents/Bristol/Transmission/stats/")
backupfolder = "../OnlineBackups/11July/"
fileList = list.files(paste(backupfolder,"logs/",sep=''),"Files*")
justFilename = function(X){
sapply(X, function(x){
x = strsplit(X,"/")[[1]]
return(x[length(x)])
})
}
processFileLog = function(filename){
fl = read.csv(
paste(backupfolder,
"logs/",
filename,
sep=''), stringsAsFactors = F)
if(nrow(fl)>0){
highPFiles = paste(fl[grepl("highp",fl$filetype),]$filename, collapse = ",")
lowPFiles = paste(fl[grepl("lowp",fl$filetype),]$filename, collapse = ",")
storyOrder = "HighP,LowP"
if(min(which(grepl("highp",fl$filetype))) > min(which(grepl("lowp",fl$filetype)))){
storyOrder = "LowP,HighP"
}
highPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("highp",fl$filetype),]$filetype[1])]
lowPStory = c("Muki","Taka")[1+grepl("taka",fl[grepl("lowp",fl$filetype),]$filetype[1])]
location = "USA"
if(sum(grepl("UK",fl$participantID))>0){
location = "UK"
}
# Distraction task data
distractionTasks = fl[grepl("distraction",fl$filetype),]$filename
# need to include one row
distractionTaskResults = data.frame(participantID=fl$participantID[1])
if(length(distractionTasks)==0){
distractionTaskResults = data.frame(
"VSLT.p.Round1"=NA,
'VSLT.d.Round1'=NA,
'VSLT.pnd.Round1'=NA,
'VSLT.p_plus_pnd.Round1'=NA,
"VSLT.p.Round2"=NA,
'VSLT.d.Round2'=NA,
'VSLT.pnd.Round2'=NA,
'VSLT.p_plus_pnd.Round2'=NA
)
} else{
for(df in distractionTasks){
df_filename = justFilename(df)
dx = read.csv(paste(backupfolder,
"distractionTask/",
df_filename,sep=''), stringsAsFactors = F)
if(!"distractionTaskNumber" %in% names(dx)){
x = strsplit(fl[grepl(df,fl$filename),]$filetype[1],"_")[[1]]
dx$distractionTaskNum = as.numeric(x[length(x)])
}
VSLT.p_plus_pnd = mean(dx$playerTechnicalPoints, na.rm=T)
VSLT.p = mean(dx$playerLocationsCorrect, na.rm=T)
VSLT.d = mean(dx$playerSymbolsCorrect, na.rm=T)
VSLT.pnd = mean(dx$playerSymbolsAndLocationsCorrect, na.rm=T)
distractionTaskResults = cbind(distractionTaskResults,
data.frame(
VSLT.p=VSLT.p,
VSLT.d=VSLT.d,
VSLT.pnd=VSLT.pnd,
VSLT.p_plus_pnd=VSLT.p_plus_pnd
))
}
distractionTaskResults = distractionTaskResults[,2:ncol(distractionTaskResults)]
names(distractionTaskResults) = c(
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round1"),sep="."),
paste(c("VSLT.p",'VSLT.d','VSLT.pnd','VSLT.p_plus_pnd'),c("Round2"),sep="."))
}
# Survey
surveyFilename = justFilename(fl[grepl("Survey",fl$filetype),]$filename[1])
surveyResults = read.csv(paste(backupfolder,
"survey/",
surveyFilename,
sep=''))
pData = data.frame(
participantID = fl$participantID[1],
location = location,
highPStory = highPStory,
highPRecordings = highPFiles,
lowPStory = lowPStory,
lowPRecordings = lowPFiles
)
pData = cbind(pData,distractionTaskResults,surveyResults)
return(pData)
}
return(NULL)
}
combineDatasets = function(a,b){
if(nrow(a)==0){
return(rbind(a,b))
}
# in a but not b
sda = setdiff(names(a),names(b))
# in b but not a
sdb = setdiff(names(b),names(a))
if(length(sda)==0 & length(sdb)==0){
return(rbind(a,b))
} else{
a[,sdb]= NA
b[,sda] = NA
b = b[,names(a)]
return(rbind(a,b))
}
}
results.UK = data.frame()
results.USA = data.frame()
for(f in fileList){
dx = processFileLog(f)
if(!is.null(dx)){
if(dx$location=="USA"){
results.USA = combineDatasets(results.USA,dx)
} else{
results.UK = combineDatasets(results.UK,dx)
}
}
}
write.csv(results.UK, file = 'results/Results_UK.csv')
write.csv(results.USA, file = 'results/Results_USA.csv')
